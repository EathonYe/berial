{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import { App } from './types'\nlet apps: App[] = []\n\nexport function define(\n  tag: string,\n  component: App['component'],\n  route: string\n): void {\n  class Berial extends HTMLElement {\n    static get componentName() {\n      return tag\n    }\n\n    constructor() {\n      super()\n      for (const k in component) {\n        // eslint-disable-next-line @typescript-eslint/no-extra-semi\n        ;(this as any)[k] = (component as any)[k]\n      }\n    }\n\n    connectedCallback() {\n      this.attachShadow({\n        mode: 'open'\n      })\n\n      apps.push({\n        tag,\n        component,\n        route,\n        element: this\n      })\n    }\n  }\n  const hasDef = window.customElements.get(tag)\n  if (!hasDef) {\n    customElements.define(tag, Berial)\n  }\n}\n\nexport function start(): void {\n  apps.forEach((app) => {\n    const host = new Proxy(app.element, {\n      get(target, key: string) {\n        return target[key]\n      },\n      set(target, key: string, val) {\n        target[key] = val\n        process(app, host)\n        return true\n      }\n    })\n    process(app, host)\n  })\n}\n\nfunction process(app: App, host: HTMLElement) {\n  const path = window.location.hash || window.location.pathname || '/'\n\n  if (app.route === path) {\n    app.component.mount(host)\n  } else {\n    app.component.unmount(host)\n  }\n}\n\nwindow.addEventListener('hashchange', start)\nwindow.addEventListener('popstate', start)\n"],"names":[],"mappings":";;;;;;EACA,IAAI,IAAI,GAAU,EAAE,CAAA;WAEJ,MAAM,CACpB,GAAW,EACX,SAA2B,EAC3B,KAAa;MAEb,MAAM,MAAO,SAAQ,WAAW;UAC9B,WAAW,aAAa;cACtB,OAAO,GAAG,CAAA;WACX;UAED;cACE,KAAK,EAAE,CAAA;cACP,KAAK,MAAM,CAAC,IAAI,SAAS,EAAE;kBAEvB,IAAY,CAAC,CAAC,CAAC,GAAI,SAAiB,CAAC,CAAC,CAAC,CAAA;eAC1C;WACF;UAED,iBAAiB;cACf,IAAI,CAAC,YAAY,CAAC;kBAChB,IAAI,EAAE,MAAM;eACb,CAAC,CAAA;cAEF,IAAI,CAAC,IAAI,CAAC;kBACR,GAAG;kBACH,SAAS;kBACT,KAAK;kBACL,OAAO,EAAE,IAAI;eACd,CAAC,CAAA;WACH;OACF;MACD,MAAM,MAAM,GAAG,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;MAC7C,IAAI,CAAC,MAAM,EAAE;UACX,cAAc,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,CAAA;OACnC;EACH,CAAC;WAEe,KAAK;MACnB,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG;UACf,MAAM,IAAI,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE;cAClC,GAAG,CAAC,MAAM,EAAE,GAAW;kBACrB,OAAO,MAAM,CAAC,GAAG,CAAC,CAAA;eACnB;cACD,GAAG,CAAC,MAAM,EAAE,GAAW,EAAE,GAAG;kBAC1B,MAAM,CAAC,GAAG,CAAC,GAAG,GAAG,CAAA;kBACjB,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;kBAClB,OAAO,IAAI,CAAA;eACZ;WACF,CAAC,CAAA;UACF,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;OACnB,CAAC,CAAA;EACJ,CAAC;EAED,SAAS,OAAO,CAAC,GAAQ,EAAE,IAAiB;MAC1C,MAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,IAAI,GAAG,CAAA;MAEpE,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,EAAE;UACtB,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA;OAC1B;WAAM;UACL,GAAG,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;OAC5B;EACH,CAAC;EAED,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,KAAK,CAAC,CAAA;EAC5C,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,KAAK,CAAC;;;;;;;;;;;;;"}