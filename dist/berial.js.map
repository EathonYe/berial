{"version":3,"file":"berial.js","sources":["../index.js"],"sourcesContent":["const LOAD = 0\r\n\r\nlet apps = []\r\n\r\nexport function define(view, route) {\r\n  class Berial extends HTMLElement {\r\n    constructor() {\r\n      super()\r\n      let template = document.createElement('template')\r\n      template.innerHTML = '<div></div>'\r\n      this.attachShadow({\r\n        mode: 'open',\r\n      }).appendChild(template.content.cloneNode(true))\r\n    }\r\n  }\r\n\r\n\r\n\r\n  const hasDef = window.customElements.get('berial-app')\r\n  if (!hasDef) {\r\n\r\n    customElements.define('berial-app', Berial)\r\n  }\r\n\r\n  apps.push({\r\n    view,\r\n    route,\r\n    Berial,\r\n  })\r\n\r\n  return invoke()\r\n}\r\n\r\nfunction invoke() {\r\n  const current = window.location.hash\r\n\r\n  let ps = apps.filter((item) => item.route === current).map(shouldLoad)\r\n  return Promise.all(ps)\r\n    .then(() => {\r\n      return apps\r\n    })\r\n    .catch((e) => {\r\n      console.log(e)\r\n    })\r\n}\r\n\r\nfunction shouldLoad(app) {\r\n  let p = app.view({})\r\n  return p\r\n    .then((module) => {\r\n      queueJob(module.render, app.Berial)\r\n    })\r\n    .catch((e) => {\r\n      return app\r\n    })\r\n}\r\n\r\nfunction queueJob(queue, Berial) {\r\n  queue.forEach((item) => {\r\n    item(Berial.shadowRoot)\r\n  })\r\n}\r\n\r\nwindow.addEventListener('hashchange', invoke)\r\nwindow.addEventListener('popstate', invoke)\r\n"],"names":[],"mappings":";;;;;;EAEA,IAAI,IAAI,GAAG,GAAE;AACb;EACO,SAAS,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE;EACpC,EAAE,MAAM,MAAM,SAAS,WAAW,CAAC;EACnC,IAAI,WAAW,GAAG;EAClB,MAAM,KAAK,GAAE;EACb,MAAM,IAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,EAAC;EACvD,MAAM,QAAQ,CAAC,SAAS,GAAG,cAAa;EACxC,MAAM,IAAI,CAAC,YAAY,CAAC;EACxB,QAAQ,IAAI,EAAE,MAAM;EACpB,OAAO,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAAC;EACtD,KAAK;EACL,GAAG;AACH;AACA;AACA;EACA,EAAE,MAAM,MAAM,GAAG,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,YAAY,EAAC;EACxD,EAAE,IAAI,CAAC,MAAM,EAAE;AACf;EACA,IAAI,cAAc,CAAC,MAAM,CAAC,YAAY,EAAE,MAAM,EAAC;EAC/C,GAAG;AACH;EACA,EAAE,IAAI,CAAC,IAAI,CAAC;EACZ,IAAI,IAAI;EACR,IAAI,KAAK;EACT,IAAI,MAAM;EACV,GAAG,EAAC;AACJ;EACA,EAAE,OAAO,MAAM,EAAE;EACjB,CAAC;AACD;EACA,SAAS,MAAM,GAAG;EAClB,EAAE,MAAM,OAAO,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAI;AACtC;EACA,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,KAAK,OAAO,CAAC,CAAC,GAAG,CAAC,UAAU,EAAC;EACxE,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;EACxB,KAAK,IAAI,CAAC,MAAM;EAChB,MAAM,OAAO,IAAI;EACjB,KAAK,CAAC;EACN,KAAK,KAAK,CAAC,CAAC,CAAC,KAAK;EAClB,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,EAAC;EACpB,KAAK,CAAC;EACN,CAAC;AACD;EACA,SAAS,UAAU,CAAC,GAAG,EAAE;EACzB,EAAE,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,EAAC;EACtB,EAAE,OAAO,CAAC;EACV,KAAK,IAAI,CAAC,CAAC,MAAM,KAAK;EACtB,MAAM,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,MAAM,EAAC;EACzC,KAAK,CAAC;EACN,KAAK,KAAK,CAAC,CAAC,CAAC,KAAK;EAClB,MAAM,OAAO,GAAG;EAChB,KAAK,CAAC;EACN,CAAC;AACD;EACA,SAAS,QAAQ,CAAC,KAAK,EAAE,MAAM,EAAE;EACjC,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;EAC1B,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,EAAC;EAC3B,GAAG,EAAC;EACJ,CAAC;AACD;EACA,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,MAAM,EAAC;EAC7C,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM;;;;;;;;;;;;"}