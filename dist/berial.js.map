{"version":3,"file":"berial.js","sources":["../index.js"],"sourcesContent":["const LOAD = 0\r\n\r\nlet apps = []\r\n\r\nexport function define(view, route) {\r\n  apps.push({\r\n    view,\r\n    route,\r\n    status: LOAD,\r\n  })\r\n  return invoke()\r\n}\r\n\r\nfunction invoke() {\r\n    const hash = window.location.hash\r\n\r\n  let ps = apps.map(shouldLoad).filter(item=>item.route === hash)\r\n  console.log(ps)\r\n  return Promise.all(ps)\r\n    .then(() => {\r\n      return apps\r\n    })\r\n    .catch((e) => {\r\n      console.log(e)\r\n    })\r\n}\r\n\r\nfunction shouldLoad(app) {\r\n  let p = app.view({})\r\n  return p\r\n    .then((module) => {\r\n      app.render = queueJob(module.render)\r\n      return app\r\n    })\r\n    .catch((e) => {\r\n      console.log(e)\r\n      return app\r\n    })\r\n}\r\n\r\nfunction queueJob(queue) {\r\n  return (props) => {\r\n    return new Promise((resolve, reject) => {\r\n      wait(0)\r\n      function wait(i) {\r\n        const fn = queue[i](props)\r\n        fn.then(() => {\r\n          if (i === queue.length - 1) {\r\n            resolve()\r\n          } else {\r\n            wait(i++)\r\n          }\r\n        }).catch((e) => reject(e))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction reroute() {\r\n    \r\n  }\r\n\r\n\r\nwindow.addEventListener('hashchange', reroute);\r\nwindow.addEventListener('popstate', reroute);\r\n"],"names":[],"mappings":";;;;;;EAAA,MAAM,IAAI,GAAG,EAAC;AACd;EACA,IAAI,IAAI,GAAG,GAAE;AACb;EACO,SAAS,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE;EACpC,EAAE,IAAI,CAAC,IAAI,CAAC;EACZ,IAAI,IAAI;EACR,IAAI,KAAK;EACT,IAAI,MAAM,EAAE,IAAI;EAChB,GAAG,EAAC;EACJ,EAAE,OAAO,MAAM,EAAE;EACjB,CAAC;AACD;EACA,SAAS,MAAM,GAAG;EAClB,IAAI,MAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAI;AACrC;EACA,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,KAAK,IAAI,EAAC;EACjE,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE,EAAC;EACjB,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;EACxB,KAAK,IAAI,CAAC,MAAM;EAChB,MAAM,OAAO,IAAI;EACjB,KAAK,CAAC;EACN,KAAK,KAAK,CAAC,CAAC,CAAC,KAAK;EAClB,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,EAAC;EACpB,KAAK,CAAC;EACN,CAAC;AACD;EACA,SAAS,UAAU,CAAC,GAAG,EAAE;EACzB,EAAE,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,EAAC;EACtB,EAAE,OAAO,CAAC;EACV,KAAK,IAAI,CAAC,CAAC,MAAM,KAAK;EACtB,MAAM,GAAG,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAC;EAC1C,MAAM,OAAO,GAAG;EAChB,KAAK,CAAC;EACN,KAAK,KAAK,CAAC,CAAC,CAAC,KAAK;EAClB,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,EAAC;EACpB,MAAM,OAAO,GAAG;EAChB,KAAK,CAAC;EACN,CAAC;AACD;EACA,SAAS,QAAQ,CAAC,KAAK,EAAE;EACzB,EAAE,OAAO,CAAC,KAAK,KAAK;EACpB,IAAI,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;EAC5C,MAAM,IAAI,CAAC,CAAC,EAAC;EACb,MAAM,SAAS,IAAI,CAAC,CAAC,EAAE;EACvB,QAAQ,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,EAAC;EAClC,QAAQ,EAAE,CAAC,IAAI,CAAC,MAAM;EACtB,UAAU,IAAI,CAAC,KAAK,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;EACtC,YAAY,OAAO,GAAE;EACrB,WAAW,MAAM;EACjB,YAAY,IAAI,CAAC,CAAC,EAAE,EAAC;EACrB,WAAW;EACX,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,EAAC;EAClC,OAAO;EACP,KAAK,CAAC;EACN,GAAG;EACH,CAAC;AACD;EACA,SAAS,OAAO,GAAG;EACnB;EACA,GAAG;AACH;AACA;EACA,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;EAC/C,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,OAAO,CAAC;;;;;;;;;;;;"}